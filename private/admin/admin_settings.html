<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finanza - Admin Settings</title>
    <link href="/static/css/style.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        .admin-nav { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .settings-container { background: white; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); overflow: hidden; }
        .settings-sidebar { background: #f8f9fa; padding: 20px; border-right: 1px solid #dee2e6; min-height: 500px; }
        .settings-sidebar .nav-link { color: #333; padding: 12px 15px; border-left: 3px solid transparent; margin-bottom: 5px; }
        .settings-sidebar .nav-link:hover { background: #e9ecef; }
        .settings-sidebar .nav-link.active { background: #e3f2fd; border-left-color: #667eea; color: #667eea; font-weight: 600; }
        .settings-content { padding: 30px; }
        .settings-section { display: none; }
        .settings-section.active { display: block; }
        .form-control:focus { border-color: #667eea; box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25); }
        .btn-primary { background: #667eea; border: none; }
        .btn-primary:hover { background: #5568d3; }
        .setting-item { padding: 20px; background: #f8f9fa; border-radius: 8px; margin-bottom: 15px; }
        .setting-item h6 { margin-bottom: 10px; color: #333; }
        .setting-item .form-text { color: #666; font-size: 0.85rem; }
        .alert-info { background: #e3f2fd; border: 1px solid #2196f3; color: #1565c0; }
        .toggle-switch { position: relative; display: inline-block; width: 50px; height: 24px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: 0.4s; border-radius: 24px; }
        .toggle-slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: 0.4s; border-radius: 50%; }
        input:checked + .toggle-slider { background-color: #667eea; }
        input:checked + .toggle-slider:before { transform: translateX(26px); }
    </style>
</head>
<body>
    <nav class="admin-nav navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="/user/admin/dashboard"><i class="fas fa-chart-line"></i> Finanza Admin</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarAdmin">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarAdmin">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/user/admin/dashboard"><i class="fas fa-home"></i> Dashboard</a></li>
                    <li class="nav-item"><a class="nav-link" href="/logout"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <div class="mb-4">
            <h2><i class="fas fa-cog"></i> Admin Settings</h2>
            <p class="text-muted">Configure system settings and preferences</p>
        </div>

        <div class="settings-container">
            <div class="row g-0">
                <!-- Sidebar -->
                <div class="col-md-3">
                    <div class="settings-sidebar">
                        <nav class="nav flex-column">
                            <a class="nav-link active" href="#" onclick="showSection('general', event)">
                                <i class="fas fa-sliders-h"></i> General Settings
                            </a>
                            <a class="nav-link" href="#" onclick="showSection('security', event)">
                                <i class="fas fa-lock"></i> Security
                            </a>
                            <a class="nav-link" href="#" onclick="showSection('email', event)">
                                <i class="fas fa-envelope"></i> Email Configuration
                            </a>
                            <a class="nav-link" href="#" onclick="showSection('notifications', event)">
                                <i class="fas fa-bell"></i> Notifications
                            </a>
                            <a class="nav-link" href="#" onclick="showSection('kyc', event)">
                                <i class="fas fa-file-alt"></i> KYC Settings
                            </a>
                            <a class="nav-link" href="#" onclick="showSection('payment', event)">
                                <i class="fas fa-credit-card"></i> Payment Settings
                            </a>
                            <a class="nav-link" href="#" onclick="showSection('maintenance', event)">
                                <i class="fas fa-tools"></i> Maintenance
                            </a>
                            <a class="nav-link" href="#" onclick="showSection('backup', event)">
                                <i class="fas fa-database"></i> Backup
                            </a>
                        </nav>
                    </div>
                </div>

                <!-- Settings Content -->
                <div class="col-md-9">
                    <div class="settings-content">
                        <!-- General Settings -->
                        <div id="general" class="settings-section active">
                            <h4><i class="fas fa-sliders-h"></i> General Settings</h4>
                            <hr>
                            <div class="setting-item">
                                <h6>Platform Name</h6>
                                <input type="text" class="form-control" value="Finanza">
                                <small class="form-text">The name of your financial platform</small>
                            </div>
                            <div class="setting-item">
                                <h6>Platform URL</h6>
                                <input type="text" class="form-control" value="https://finanza.example.com">
                                <small class="form-text">Your main website URL</small>
                            </div>
                            <div class="setting-item">
                                <h6>Support Email</h6>
                                <input type="email" class="form-control" value="support@finanza.com">
                                <small class="form-text">Email for customer support inquiries</small>
                            </div>
                            <div class="setting-item">
                                <h6>Default Currency</h6>
                                <select class="form-control">
                                    <option>USD - US Dollar</option>
                                    <option>EUR - Euro</option>
                                    <option>GBP - British Pound</option>
                                </select>
                            </div>
                            <button class="btn btn-primary mt-3"><i class="fas fa-save"></i> Save Changes</button>
                        </div>

                        <!-- Security Settings -->
                        <div id="security" class="settings-section">
                            <h4><i class="fas fa-lock"></i> Security Settings</h4>
                            <hr>
                            <div class="alert alert-info mb-4">
                                <i class="fas fa-info-circle"></i> Manage security and access control settings
                            </div>
                            <div class="setting-item">
                                <h6>Enable Two-Factor Authentication</h6>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <small class="form-text">Require 2FA for all admin accounts</small>
                            </div>
                            <div class="setting-item">
                                <h6>Password Expiry (Days)</h6>
                                <input type="number" class="form-control" value="90">
                                <small class="form-text">Force password change every N days (0 = disabled)</small>
                            </div>
                            <div class="setting-item">
                                <h6>Session Timeout (Minutes)</h6>
                                <input type="number" class="form-control" value="30">
                                <small class="form-text">Auto-logout after inactivity</small>
                            </div>
                            <div class="setting-item">
                                <h6>Max Login Attempts</h6>
                                <input type="number" class="form-control" value="5">
                                <small class="form-text">Lockout account after N failed attempts</small>
                            </div>
                            <button class="btn btn-primary mt-3"><i class="fas fa-save"></i> Save Changes</button>
                        </div>

                        <!-- Email Configuration -->
                        <div id="email" class="settings-section">
                            <h4><i class="fas fa-envelope"></i> Email Configuration</h4>
                            <hr>
                            <div class="setting-item">
                                <h6>SMTP Host</h6>
                                <input type="text" class="form-control" value="smtp.gmail.com">
                            </div>
                            <div class="setting-item">
                                <h6>SMTP Port</h6>
                                <input type="number" class="form-control" value="587">
                            </div>
                            <div class="setting-item">
                                <h6>SMTP Username</h6>
                                <input type="email" class="form-control" placeholder="your-email@gmail.com">
                            </div>
                            <div class="setting-item">
                                <h6>SMTP Password</h6>
                                <input type="password" class="form-control" placeholder="••••••••">
                                <small class="form-text">Your email password or app password</small>
                            </div>
                            <div class="setting-item">
                                <h6>From Email Address</h6>
                                <input type="email" class="form-control" value="noreply@finanza.com">
                            </div>
                            <button class="btn btn-primary mt-3"><i class="fas fa-save"></i> Save Changes</button>
                        </div>

                        <!-- Notifications -->
                        <div id="notifications" class="settings-section">
                            <h4><i class="fas fa-bell"></i> Notification Settings</h4>
                            <hr>
                            <div class="setting-item">
                                <h6>Send Email on New User Registration</h6>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <h6>Send Email on KYC Submission</h6>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <h6>Send Email on Large Transactions</h6>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <h6>Large Transaction Threshold ($)</h6>
                                <input type="number" class="form-control" value="10000">
                            </div>
                            <button class="btn btn-primary mt-3"><i class="fas fa-save"></i> Save Changes</button>
                        </div>

                        <!-- KYC Settings -->
                        <div id="kyc" class="settings-section">
                            <h4><i class="fas fa-file-alt"></i> KYC Settings</h4>
                            <hr>
                            <div class="setting-item">
                                <h6>Require KYC for Deposits</h6>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <h6>Require KYC for Transfers</h6>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <h6>Auto-approve KYC if Score > </h6>
                                <input type="number" class="form-control" value="85" max="100">
                                <small class="form-text">Set to 0 to disable auto-approval</small>
                            </div>
                            <div class="setting-item">
                                <h6>KYC Verification Duration (Days)</h6>
                                <input type="number" class="form-control" value="365">
                                <small class="form-text">Re-verify KYC every N days</small>
                            </div>
                            <button class="btn btn-primary mt-3"><i class="fas fa-save"></i> Save Changes</button>
                        </div>

                        <!-- Payment Settings -->
                        <div id="payment" class="settings-section">
                            <h4><i class="fas fa-credit-card"></i> Payment Settings</h4>
                            <hr>
                            <div class="setting-item">
                                <h6>Enable Deposits</h6>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <h6>Enable Withdrawals</h6>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <h6>Minimum Deposit Amount ($)</h6>
                                <input type="number" class="form-control" value="10">
                            </div>
                            <div class="setting-item">
                                <h6>Maximum Withdrawal Amount ($)</h6>
                                <input type="number" class="form-control" value="100000">
                            </div>
                            <button class="btn btn-primary mt-3"><i class="fas fa-save"></i> Save Changes</button>
                        </div>

                        <!-- Maintenance -->
                        <div id="maintenance" class="settings-section">
                            <h4><i class="fas fa-tools"></i> Maintenance</h4>
                            <hr>
                            <div class="alert alert-warning mb-4">
                                <i class="fas fa-exclamation-triangle"></i> <strong>Warning:</strong> Maintenance mode will disable user access.
                            </div>
                            <div class="setting-item">
                                <h6>Enable Maintenance Mode</h6>
                                <label class="toggle-switch">
                                    <input type="checkbox">
                                    <span class="toggle-slider"></span>
                                </label>
                                <small class="form-text">Display maintenance message to users</small>
                            </div>
                            <div class="setting-item">
                                <h6>Maintenance Message</h6>
                                <textarea class="form-control" rows="4" placeholder="We are performing scheduled maintenance..."></textarea>
                            </div>
                            <button class="btn btn-primary mt-3"><i class="fas fa-save"></i> Save Changes</button>
                        </div>

                        <!-- Backup -->
                        <div id="backup" class="settings-section">
                            <h4><i class="fas fa-database"></i> Backup & Database</h4>
                            <hr>
                            <div class="setting-item">
                                <h6>Last Backup</h6>
                                <p class="text-muted">Today at 02:00 AM</p>
                            </div>
                            <div class="setting-item">
                                <h6>Auto Backup Enabled</h6>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <small class="form-text">Automatically backup database daily</small>
                            </div>
                            <div class="setting-item">
                                <h6>Backup Schedule</h6>
                                <select class="form-control">
                                    <option>Daily at 2:00 AM</option>
                                    <option>Every 6 hours</option>
                                    <option>Every 12 hours</option>
                                </select>
                            </div>
                            <button class="btn btn-success mt-3"><i class="fas fa-arrow-down"></i> Download Latest Backup</button>
                            <button class="btn btn-danger mt-3 ms-2"><i class="fas fa-sync"></i> Manual Backup Now</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/admin_static/js/auth-helper.js"></script>
    <script>
        function showSection(sectionId, event) {
            event.preventDefault();
            
            // Hide all sections
            document.querySelectorAll('.settings-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all nav links
            document.querySelectorAll('.settings-sidebar .nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Add active class to clicked link
            event.target.closest('.nav-link').classList.add('active');
        }

        // Add save functionality
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('btn-primary') || e.target.classList.contains('btn-success')) {
                if (e.target.textContent.includes('Save') || e.target.textContent.includes('Download') || e.target.textContent.includes('Backup')) {
                    alert('Settings saved successfully!');
                }
            }
        });
    </script>
    <script src="/static/js/admin-guard.js"></script>
</body>
</html>
